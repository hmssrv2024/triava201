<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administración - Remeex Visa</title>
    <link rel="icon" href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="admin-registros.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="login-screen">
        <div class="login-container">
            <div class="login-header">
                <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="Remeex Visa" class="login-logo">
                <h1>Panel de Administración</h1>
                <p>Acceso restringido solo para administradores</p>
            </div>
            <form class="login-form" id="admin-login-form">
                <div class="form-group">
                    <label for="admin-username">Usuario</label>
                    <input type="text" id="admin-username" placeholder="Ingrese usuario" required>
                </div>
                <div class="form-group">
                    <label for="admin-password">Contraseña</label>
                    <input type="password" id="admin-password" placeholder="Ingrese contraseña" required>
                    <span class="password-toggle" id="toggle-admin-password">
                        <i class="fas fa-eye"></i>
                    </span>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-sign-in-alt"></i> Iniciar Sesión
                </button>
                <div class="error-message" id="login-error" style="display: none;"></div>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div class="admin-dashboard" id="admin-dashboard" style="display: none;">
        <!-- Header -->
        <header class="admin-header">
            <div class="header-left">
                <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="Remeex" class="header-logo">
                <h1>Panel de Administración</h1>
            </div>
            <div class="header-right">
                <button class="btn btn-icon" id="refresh-data" title="Actualizar datos">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button class="btn btn-icon" id="notifications-btn" title="Notificaciones">
                    <i class="fas fa-bell"></i>
                    <span class="badge" id="notifications-badge">0</span>
                </button>
                <div class="admin-user">
                    <span id="admin-name">Administrador</span>
                    <button class="btn btn-logout" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Salir
                    </button>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-item active" data-section="dashboard">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#users" class="nav-item" data-section="users">
                    <i class="fas fa-users"></i>
                    <span>Usuarios</span>
                </a>
                <a href="#send-money" class="nav-item" data-section="send-money">
                    <i class="fas fa-money-bill-wave"></i>
                    <span>Enviar Dinero</span>
                </a>
                <a href="#notifications" class="nav-item" data-section="notifications">
                    <i class="fas fa-bullhorn"></i>
                    <span>Notificaciones</span>
                </a>
                <a href="#activity-logs" class="nav-item" data-section="activity-logs">
                    <i class="fas fa-history"></i>
                    <span>Registro de Actividad</span>
                </a>
                <a href="#settings" class="nav-item" data-section="settings">
                    <i class="fas fa-cog"></i>
                    <span>Configuración</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section class="content-section active" id="section-dashboard">
                <div class="section-header">
                    <h2><i class="fas fa-chart-line"></i> Dashboard</h2>
                    <p>Resumen general del sistema</p>
                </div>

                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon blue">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="total-users">0</h3>
                            <p>Total Usuarios</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="active-users">0</h3>
                            <p>Usuarios Activos</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon red">
                            <i class="fas fa-user-lock"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="blocked-users">0</h3>
                            <p>Usuarios Bloqueados</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon yellow">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="total-balance">$0.00</h3>
                            <p>Balance Total</p>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="dashboard-section">
                    <h3>Actividad Reciente</h3>
                    <div class="activity-list" id="recent-activity">
                        <p class="empty-state">No hay actividad reciente</p>
                    </div>
                </div>
            </section>

            <!-- Users Section -->
            <section class="content-section" id="section-users">
                <div class="section-header">
                    <h2><i class="fas fa-users"></i> Gestión de Usuarios</h2>
                    <p>Administrar usuarios registrados</p>
                </div>

                <!-- Search and Filters -->
                <div class="toolbar">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="search-users" placeholder="Buscar por nombre, email, teléfono...">
                    </div>
                    <div class="filters">
                        <select id="filter-status">
                            <option value="all">Todos los estados</option>
                            <option value="active">Activos</option>
                            <option value="blocked">Bloqueados</option>
                        </select>
                        <select id="filter-provider">
                            <option value="all">Todos los métodos</option>
                            <option value="email">Email</option>
                            <option value="google">Google</option>
                        </select>
                        <button class="btn btn-secondary" id="export-users">
                            <i class="fas fa-download"></i> Exportar
                        </button>
                    </div>
                </div>

                <!-- Users Table -->
                <div class="table-container">
                    <table class="users-table">
                        <thead>
                            <tr>
                                <th>
                                    <input type="checkbox" id="select-all-users">
                                </th>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Teléfono</th>
                                <th>Balance</th>
                                <th>Estado</th>
                                <th>Método</th>
                                <th>Registro</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="users-table-body">
                            <tr>
                                <td colspan="9" class="empty-state">Cargando usuarios...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                <div class="pagination" id="users-pagination">
                    <button class="btn btn-secondary" id="prev-page" disabled>
                        <i class="fas fa-chevron-left"></i> Anterior
                    </button>
                    <span id="page-info">Página 1 de 1</span>
                    <button class="btn btn-secondary" id="next-page" disabled>
                        Siguiente <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <!-- Bulk Actions -->
                <div class="bulk-actions" id="bulk-actions" style="display: none;">
                    <span id="selected-count">0 usuarios seleccionados</span>
                    <div class="bulk-buttons">
                        <button class="btn btn-danger" id="bulk-delete">
                            <i class="fas fa-trash"></i> Eliminar
                        </button>
                        <button class="btn btn-warning" id="bulk-block">
                            <i class="fas fa-ban"></i> Bloquear
                        </button>
                        <button class="btn btn-success" id="bulk-unblock">
                            <i class="fas fa-check"></i> Desbloquear
                        </button>
                        <button class="btn btn-primary" id="bulk-notify">
                            <i class="fas fa-bell"></i> Notificar
                        </button>
                    </div>
                </div>
            </section>

            <!-- Send Money Section -->
            <section class="content-section" id="section-send-money">
                <div class="section-header">
                    <h2><i class="fas fa-money-bill-wave"></i> Enviar Dinero</h2>
                    <p>Transferir fondos a usuarios</p>
                </div>

                <div class="send-money-container">
                    <div class="money-form-card">
                        <h3>Envío Individual</h3>
                        <form id="send-money-form">
                            <div class="form-group">
                                <label for="recipient-search">Buscar Usuario</label>
                                <input type="text" id="recipient-search" placeholder="Buscar por nombre o email..." autocomplete="off">
                                <div class="search-results" id="recipient-results"></div>
                            </div>
                            <div class="form-group">
                                <label for="selected-recipient">Usuario Seleccionado</label>
                                <input type="text" id="selected-recipient" readonly placeholder="Ninguno">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="amount-usd">Monto USD</label>
                                    <input type="number" id="amount-usd" placeholder="0.00" step="0.01" min="0">
                                </div>
                                <div class="form-group">
                                    <label for="amount-bs">Monto Bs</label>
                                    <input type="number" id="amount-bs" placeholder="0.00" step="0.01" min="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="transfer-concept">Concepto</label>
                                <input type="text" id="transfer-concept" placeholder="Motivo de la transferencia">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="send-notification" checked>
                                    Enviar notificación al usuario
                                </label>
                            </div>
                            <button type="submit" class="btn btn-primary btn-block">
                                <i class="fas fa-paper-plane"></i> Enviar Dinero
                            </button>
                        </form>
                    </div>

                    <div class="money-history-card">
                        <h3>Historial de Transferencias</h3>
                        <div class="transfer-history" id="transfer-history">
                            <p class="empty-state">No hay transferencias recientes</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Notifications Section -->
            <section class="content-section" id="section-notifications">
                <div class="section-header">
                    <h2><i class="fas fa-bullhorn"></i> Notificaciones</h2>
                    <p>Enviar notificaciones a usuarios</p>
                </div>

                <div class="notifications-container">
                    <div class="notification-form-card">
                        <h3>Nueva Notificación</h3>
                        <form id="notification-form">
                            <div class="form-group">
                                <label for="notification-type">Tipo de Notificación</label>
                                <select id="notification-type">
                                    <option value="info">Información</option>
                                    <option value="success">Éxito</option>
                                    <option value="warning">Advertencia</option>
                                    <option value="error">Error</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="notification-target">Destinatarios</label>
                                <select id="notification-target">
                                    <option value="all">Todos los usuarios</option>
                                    <option value="active">Solo activos</option>
                                    <option value="blocked">Solo bloqueados</option>
                                    <option value="specific">Usuario específico</option>
                                </select>
                            </div>
                            <div class="form-group" id="specific-user-group" style="display: none;">
                                <label for="notification-user-search">Buscar Usuario</label>
                                <input type="text" id="notification-user-search" placeholder="Buscar por nombre o email..." autocomplete="off">
                                <div class="search-results" id="notification-user-results"></div>
                            </div>
                            <div class="form-group">
                                <label for="notification-title">Título</label>
                                <input type="text" id="notification-title" placeholder="Título de la notificación" required>
                            </div>
                            <div class="form-group">
                                <label for="notification-message">Mensaje</label>
                                <textarea id="notification-message" rows="4" placeholder="Contenido del mensaje" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary btn-block">
                                <i class="fas fa-paper-plane"></i> Enviar Notificación
                            </button>
                        </form>
                    </div>

                    <div class="notification-preview-card">
                        <h3>Vista Previa</h3>
                        <div class="notification-preview" id="notification-preview">
                            <div class="preview-notification info">
                                <i class="fas fa-info-circle"></i>
                                <div class="preview-content">
                                    <h4 id="preview-title">Título de la notificación</h4>
                                    <p id="preview-message">Contenido del mensaje aparecerá aquí...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="sent-notifications">
                    <h3>Notificaciones Enviadas</h3>
                    <div class="sent-notifications-list" id="sent-notifications-list">
                        <p class="empty-state">No hay notificaciones enviadas</p>
                    </div>
                </div>
            </section>

            <!-- Activity Logs Section -->
            <section class="content-section" id="section-activity-logs">
                <div class="section-header">
                    <h2><i class="fas fa-history"></i> Registro de Actividad</h2>
                    <p>Historial de acciones administrativas</p>
                </div>

                <div class="toolbar">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="search-logs" placeholder="Buscar en logs...">
                    </div>
                    <div class="filters">
                        <select id="filter-log-action">
                            <option value="all">Todas las acciones</option>
                            <option value="delete">Eliminaciones</option>
                            <option value="block">Bloqueos</option>
                            <option value="unblock">Desbloqueos</option>
                            <option value="send_money">Envíos de dinero</option>
                            <option value="notification">Notificaciones</option>
                        </select>
                        <button class="btn btn-secondary" id="export-logs">
                            <i class="fas fa-download"></i> Exportar
                        </button>
                    </div>
                </div>

                <div class="logs-container">
                    <div class="logs-list" id="logs-list">
                        <p class="empty-state">No hay registros de actividad</p>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section class="content-section" id="section-settings">
                <div class="section-header">
                    <h2><i class="fas fa-cog"></i> Configuración</h2>
                    <p>Configurar el panel de administración</p>
                </div>

                <div class="settings-container">
                    <div class="settings-card">
                        <h3>Seguridad</h3>
                        <form id="change-password-form">
                            <div class="form-group">
                                <label for="current-password">Contraseña Actual</label>
                                <input type="password" id="current-password" required>
                            </div>
                            <div class="form-group">
                                <label for="new-password">Nueva Contraseña</label>
                                <input type="password" id="new-password" required>
                            </div>
                            <div class="form-group">
                                <label for="confirm-password">Confirmar Contraseña</label>
                                <input type="password" id="confirm-password" required>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-key"></i> Cambiar Contraseña
                            </button>
                        </form>
                    </div>

                    <div class="settings-card">
                        <h3>Configuración de Datos</h3>
                        <div class="data-actions">
                            <button class="btn btn-warning" id="clear-cache">
                                <i class="fas fa-broom"></i> Limpiar Caché
                            </button>
                            <button class="btn btn-danger" id="delete-all-logs">
                                <i class="fas fa-trash"></i> Eliminar Todos los Logs
                            </button>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>Información del Sistema</h3>
                        <div class="system-info">
                            <p><strong>Versión:</strong> 1.0.0</p>
                            <p><strong>Último Acceso:</strong> <span id="last-access">-</span></p>
                            <p><strong>Total Logs:</strong> <span id="total-logs">0</span></p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- User Detail Modal -->
    <div class="modal" id="user-detail-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user"></i> Detalles del Usuario</h3>
                <button class="modal-close" id="close-user-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="user-detail-body">
                <!-- User details will be injected here -->
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirm-modal">
        <div class="modal-content small">
            <div class="modal-header">
                <h3 id="confirm-title">Confirmar Acción</h3>
            </div>
            <div class="modal-body">
                <p id="confirm-message">¿Está seguro de realizar esta acción?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-confirm">Cancelar</button>
                <button class="btn btn-danger" id="accept-confirm">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-message">Acción completada exitosamente</span>
    </div>

    <script src="admin-registros.js"></script>
</body>
</html>
